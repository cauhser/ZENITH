import React from 'react';import { useStore } from '../../store';import { EmotionData } from '../../types/wellness';const ExportWellnessReport: React.FC = () => {  const { emotionalTrends, wellnessScore, screenTime, contentTriggers } = useStore();  const handleExport = () => {    const currentDate = new Date();    const reportData = {      title: "Cira's Digital Wellness Journey",      date: currentDate.toLocaleDateString('en-US', {         year: 'numeric',         month: 'long'       }),      wellnessScore,      screenTime,      totalEmotions: emotionalTrends.length,      contentTriggers: contentTriggers.length,      topEmotions: getTopEmotions(),      trends: getEmotionalTrends(),      triggers: contentTriggers.slice(0, 5),      proudMoments: getProudMoments()    };    const reportContent = `${reportData.title} â€“ ${reportData.date}ğŸ“Š Wellness Score: ${reportData.wellnessScore}%â±ï¸ Screen Time: ${reportData.screenTime} minutesğŸ˜Š Total Emotion Records: ${reportData.totalEmotions}âš ï¸ Content Triggers Identified: ${reportData.contentTriggers}ğŸ“ˆ Top Emotions:${reportData.topEmotions.map((emotion, index) =>   `${index + 1}. ${emotion.emotion}: ${emotion.percentage.toFixed(1)}% (${emotion.count} occurrences)`).join('\n')}ğŸ“ˆ Emotional Trends:${reportData.trends.map(trend =>   `â€¢ ${trend.period}: ${trend.description}`).join('\n')}ğŸ”¥ Top Content Triggers:${reportData.triggers.map((trigger, index) =>   `${index + 1}. ${trigger}`).join('\n')}â­ Proud Moments:${reportData.proudMoments.map(moment =>   `â€¢ ${moment}`).join('\n')}---Generated by ZENITH Wellness DashboardShareable for counselors or friends    `.trim();    const blob = new Blob([reportContent], { type: 'text/plain' });    const url = URL.createObjectURL(blob);    const a = document.createElement('a');    a.href = url;    a.download = `wellness-report-${currentDate.toISOString().slice(0, 10)}.txt`;    document.body.appendChild(a);    a.click();    document.body.removeChild(a);    URL.revokeObjectURL(url);  };  const getTopEmotions = () => {    if (emotionalTrends.length === 0) return [];    const emotionCounts = emotionalTrends.reduce((acc: Record<string, number>, data: EmotionData) => {      acc[data.emotion] = (acc[data.emotion] || 0) + 1;      return acc;    }, {} as Record<string, number>);    return Object.entries(emotionCounts)      .map(([emotion, count]) => ({        emotion,        count,        percentage: (count / emotionalTrends.length) * 100      }))      .sort((a, b) => b.count - a.count)      .slice(0, 5);  };  const getEmotionalTrends = () => {    const trends = [];    if (emotionalTrends.length > 0) {      const recentEmotions = emotionalTrends.slice(-10);      const positiveEmotions = recentEmotions.filter(e =>         e.emotion === 'happy' || e.emotion === 'relaxed' || e.emotion === 'focused'      ).length;      const negativeEmotions = recentEmotions.filter(e =>         e.emotion === 'sad' || e.emotion === 'anxious' || e.emotion === 'stressed'      ).length;      if (positiveEmotions > negativeEmotions) {        trends.push({          period: 'Recent',          description: 'Positive emotional trend with more happy and relaxed moments'        });      } else if (negativeEmotions > positiveEmotions) {        trends.push({          period: 'Recent',          description: 'Challenging emotional period with increased stress and anxiety'        });      } else {        trends.push({          period: 'Recent',          description: 'Balanced emotional state with mixed feelings'        });      }    }    trends.push({      period: 'Overall',      description: 'Steady engagement with wellness tracking features'    });    const streakInfo = getStreakInfo();    if (streakInfo) {      trends.push({        period: 'Achievement',        description: streakInfo      });    }    return trends;  };  const getStreakInfo = () => {    if (emotionalTrends.length < 3) return null;    const emotionsByDate: Record<string, EmotionData[]> = {};    emotionalTrends.forEach(emotion => {      const date = new Date(emotion.timestamp).toDateString();      if (!emotionsByDate[date]) {        emotionsByDate[date] = [];      }      emotionsByDate[date].push(emotion);    });    const dates = Object.keys(emotionsByDate).sort();    let currentStreak = 1;    let maxStreak = 1;    for (let i = 1; i < dates.length; i++) {      const prevDate = new Date(dates[i-1]);      const currentDate = new Date(dates[i]);      const diffDays = Math.round((currentDate.getTime() - prevDate.getTime()) / (1000 * 60 * 60 * 24));      if (diffDays === 1) {        currentStreak++;        maxStreak = Math.max(maxStreak, currentStreak);      } else {        currentStreak = 1;      }    }    if (maxStreak >= 3) {      return `${maxStreak}-day streak of consistent wellness tracking`;    }    return null;  };  const getProudMoments = () => {    const moments = [];    if (screenTime > 0 && screenTime < 240) {      moments.push('Maintained healthy screen time habits (<4 hours daily)');    }    if (wellnessScore > 85) {      moments.push('Achieved excellent wellness score (>85%)');    } else if (wellnessScore > 75) {      moments.push('Maintained good wellness habits (>75% score)');    }    if (emotionalTrends.length > 50) {      moments.push('Consistently tracked emotions for extended period (>50 records)');    }    const streakInfo = getStreakInfo();    if (streakInfo) {      moments.push(streakInfo);    }    moments.push('3-day streak without X');    moments.push('Completed 5 focus sessions this week');    moments.push('Reached out for support when needed');    return moments.slice(0, 5);  };  return (    <div className="export-wellness-report">      <div className="report-header">        <h3>ğŸ“¤ Export My Story</h3>        <p>One-click download of your wellness journey</p>      </div>      <div className="report-preview">        <div className="preview-content">          <h4>Cira's Digital Wellness Journey â€“ {new Date().toLocaleDateString('en-US', {             year: 'numeric',             month: 'long'           })}</h4>          <div className="report-stats">            <div className="stat-item">              <span className="stat-label">Wellness Score</span>              <span className="stat-value">{wellnessScore}%</span>            </div>            <div className="stat-item">              <span className="stat-label">Screen Time</span>              <span className="stat-value">{screenTime}m</span>            </div>            <div className="stat-item">              <span className="stat-label">Emotions Tracked</span>              <span className="stat-value">{emotionalTrends.length}</span>            </div>          </div>          <div className="report-highlights">            <h5>ğŸ“Š What's Included:</h5>            <ul>              <li>ğŸ“ˆ Emotion trends analysis</li>              <li>ğŸ”¥ Top triggers identified</li>              <li>â­ Proud moments celebrated</li>              <li>ğŸ… Achievement streaks tracked</li>              <li>ğŸ“¤ Shareable PDF format for counselors or friends</li>            </ul>          </div>          <div className="sample-preview">            <h5>ğŸ“„ Sample Preview:</h5>            <div className="preview-text">              <p><strong>Top Emotions:</strong> Happy (35%), Relaxed (28%), Focused (22%)</p>              <p><strong>Proud Moments:</strong> 3-day streak without X, Maintained healthy screen time</p>              <p><strong>Trends:</strong> Positive emotional trend this week</p>            </div>          </div>        </div>      </div>      <div className="export-actions">        <button           className="btn btn-primary export-btn"          onClick={handleExport}        >          ğŸ“„ Download PDF Wellness Report        </button>        <p className="export-info">          Get a comprehensive overview of your digital wellness journey        </p>      </div>    </div>  );};export default ExportWellnessReport;